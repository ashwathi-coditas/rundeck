version: "3"

services:
  rundeck:
    image: rundeck/rundeck
    hostname: rundeck1
    environment:
      - RUNDECK_NODE=localhost
      - RUNDECK_URL=http://localhost:4440/
      - LAUNCHER_URL=${LAUNCHER_URL}
      - CLI_DEB_URL=${CLI_DEB_URL}
      - CLI_VERS=${CLI_VERS}
      - SETUP_TEST_PROJECT=test
      - TEST_NC_PORT=4444
      - TEST_NC_HOST=localhost
      - WAIT_NODES=localhost
    ports: ['4440:4440']
    volumes:
      - logs:/home/rundeck/logs:rw
      - resources:/home/rundeck/resources:rw
      - tests:/home/rundeck/tests:rw

  selenium:
    image: rundeck/selenium@sha256:a7579fed4d16004f3e32d1cfd12ce4b4fbc81c58041cb9e324902caedeb36447
    tty: true
    network_mode: ${NETWORK:-bridge}
    links:
    - rundeck
    volumes:
    - ./:/app 
    - node_modules:/app/node_modules:nocopy

volumes:
  logs:
  resources:
  tests:
  node_modules: